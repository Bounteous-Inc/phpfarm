phpfarm
=======

Set of scripts to install a dozen of PHP versions in parallel on a system.
It also creates a Pyrus installation for each PHP version.
Primarily developed for PEAR's continuous integration machine.

The PHP source packages are fetched from ``museum.php.net`` (which is not
always up-to-date), the official php.net download pages and the
pre-release channels.
If a file cannot be found, try to fetch it manually and put it into
``src/bzips/``.


Setup
-----
- Check out phpfarm from git:
  ``git clone git://git.code.sf.net/p/phpfarm/code phpfarm``
- ``cd phpfarm/src/``
- ``./compile.sh 5.3.0``
- PHP gets installed into ``phpfarm/inst/php-$version/``
- ``phpfarm/inst/bin/php-$version`` is also executable
  You should add ``inst/bin`` to your ``$PATH``, i.e.
  ``PATH="$PATH:$HOME/phpfarm/inst/bin"`` in ``.bashrc``


Configure options customization
-------------------------------
Default configuration options are in ``src/options.sh``.
You may create version-specific custom option files:

- ``custom-options.sh``
- ``custom-options-5.sh``
- ``custom-options-5.3.sh``
- ``custom-options-5.3.1.sh``

The shell script needs to define a variable "``$configoptions``" with
all ``./configure`` options.
Do not try to change ``prefix`` and ``exec-prefix``.


php.ini customization
---------------------
``php.ini`` values may also be customized:

- ``custom-php.ini``
- ``custom-php-5.ini``
- ``custom-php-5.3.ini``
- ``custom-php-5.3.1.ini``

Please note that a few substitutions are done in those files in order
to generate the final php.ini configuration file. Namely, the following
variables are substitued:

- ``$ext_dir`` gets replaced by the path to the extension directory
  This is mostly used to set the ``extension_dir`` option to the right
  value. 
  This is also useful when installing a ``zend_extension`` like
  Xdebug as ``extension_dir`` is not automatically prepended to the
  path for those extensions.


Known issues
------------
The following entries are known issues which may or may not be solved
in the future:

- Do not use ``--enable-sigchld`` in your custom options if you plan
  to install extensions using pear/pecl. When enabled, this option
  will result in a failure during the ``phpize`` step (this issue
  lies in PHP itself and is not specific to phpfarm).

- By default, a (local) PEAR installation is created for every PHP version
  you build. If you don't plan to use PEAR, you can prevent this from
  happening by adding ``--without-pear`` to your ``$configoptions``.
